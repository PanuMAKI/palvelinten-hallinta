# h3 Soitto kotiin
## x) tiivistäminen
Karvinen 2021: Two Machine Virtual Network With Debian 11 Bullseye and Vagrant 
- vagrant lataus ohje linuxsille
- alkuun pääsyyn ohjeet vagrantin käytössä
- valmis vagrantfile

Karvinen 2018: Salt Quickstart – Salt Stack Master and Slave on Ubuntu Linux
- Pika ohje saltin käyttöön
- miten slave saa yhteyden masteriin
- salt komentoja joilla testata yhteys

Karvinen 2023: Salt Vagrant - automatically provision one master and two slaves kohdat : Infra as Code - Your wishes as a text file, top.sls - What Slave Runs What States
- ohje tekstitiedoston tekemiseen yaml koodilla ja sen ajaminen saltilla
- ohje top filen tekoon. 

## a) Vagrantin lataaminen windowsille
Latasin vagrantin windowsille ja loin uuden kansoin nimeltä twohost. windows komento keskuksessa siirryin kansioon ja laitoin komennon "vagrant init" joka loi vagrantfilen kansioon.

## b) Tietokoneen tekeminen vagrantilla
Uuteen Vagrantfileen laitoin valmiin koodin Karvinen 2021: Two Machine Virtual Network With Debian 11 Bullseye and Vagrant artikkelista. 

koodiin piti vain vaihtaa debianin versio bullseyesta bookwormiin.

sitten laitoin windows commandpromptiin "vagrant up" komennon joka käynnisti kaksi tietokonetta t001 ja t002.

## c) Yhteyden testaus 
testasin saavatko tietokoneet yhteyttä toisiinsa "ping -c 192.168.88.102" komenolla ja toisella koneella "ping -c 192.168.88.101".

Sain molemilta koneilta saman tuloksen :<img width="598" height="134" alt="vagrant ping" src="https://github.com/user-attachments/assets/25f1d556-afd9-4cc1-bd1d-c7a42cbf1670" />
(tietenkin eri ip osoitteilla)

## d) Salt herra orja arkkitehtuuri
Tein t001 koneesta masterin ja t002 koneesta slaven. eli latasin toiselle salt-masterin ja toiselle salt-minionin.

tein t002 koneen komennolla " sudoedit /etc/salt/minion" muokkasin minion tiedostoa ja laitoin sinne t001 koneen osoitteen. jonka jälkeen käynnistin salt-minionin uudelleen komennolla "sudo systemctl restart salt-minion.service.

tämä komento jäi jumittamaan aluksi joten keskeytin sen ja käytin komentoa "sudo systemctl kill salt-minion" jotta se sammuisi ja tämän jälkeen vaihdoin komennosta osan "kill" osaan "start" jolloin se käynnistyi uudelleen. Tämän jälkeen systemctl restart komento toimi ilman ongelmia. 

t001 koneella syötin komennon sudo salt-key jossa näin t002 koneen ei hyväksytyissa avaimissa. Tämän jälkeen koska muita avaimia ei ollut syötin komennon "sudo salt-key -A" joka hyväksyy kaikki hyväksymättömät avaimet. 
<img width="437" height="114" alt="vagrant yhteys ok" src="https://github.com/user-attachments/assets/aa664832-a3bb-4c24-a19a-54d0ab85f634" />


tämän jälkeen testasin yhteyden luomalla /srv/salt/hello hakemiston ja lisäsin sinne init.sls tiedoston johon kirjoitin  yaml kielellä koodin: 

/tmp/infra-as-code:
  file.managed

  seuraavaksi ajoin koodin ja sain seuraavan tuloksen joka kertoo että t002 koneelle on luotu uusi tekstitiedosto infra-as-code

<img width="515" height="401" alt="kuva" src="https://github.com/user-attachments/assets/01fa8dba-8058-4f92-a1b5-3dea2892567f" />

kävin vielä tarkistamassa t002 koneelta että tiedosto oli luotu ongelmitta.

## e) verkon yli tilojen kokeilu
muutin aikaisemmin tehtyä teidostoa laittamalla sinne koodin:
<img width="275" height="208" alt="Näyttökuva 2025-11-10 030309" src="https://github.com/user-attachments/assets/ac7cd0f7-8cee-4702-a29b-d587f2529a13" />
 
tämä tiedosto tekee minionille uuden käyttäjän jonka nimi on uusi ja lataa apache2 ohjelman jos sitä ei ole ladattu 


ajoin tiedoston saltilla ja sain tulokseksi: <img width="380" height="994" alt="kuva" src="https://github.com/user-attachments/assets/3c19c84f-2d3e-476d-9dbd-8445dd9db7df" />

