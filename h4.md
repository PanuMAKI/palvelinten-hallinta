# h4 Pkg-file-service

## x) tiivistäminen

Karvinen 2018: Pkg-File-Service – Control Daemons with Salt – Change SSH Server Port
- Ohje vaihtamaan ssh portti saltilla
- ssh tiedosto eri linux versiolle

## a) Uuden portin lisääminen

aloitin tarkastamalla ssh config tiedoston ja lisäsin sinne uuden portin 2222 ja käynnistin ssh:n uudestaan.
koska tein vagrantilla varmistin että en vahingossa poistanut porttia 22 koska siinä on oma ssh yhteys.

testasin että uusi portti kuuntelee komenolla ssh -p 2222 t001 ja sain vastauksen: <img width="410" height="21" alt="vagrant ssh1" src="https://github.com/user-attachments/assets/70ed55aa-1262-4a3a-b0c4-784738bfef65" />

Eli portti vastaa.

seuraavaksi tein tiedoston /srv/salt/ssh/init.sls
johon laitoin seuraavan koodin: 
<img width="434" height="354" alt="init sls" src="https://github.com/user-attachments/assets/97fb2fcd-3354-445b-a96a-7334e5ae553d" />

seuraavaksi tein tiedoston /srv/salt/sshd/sshd_config

sinne lisäsin asetukset jotka halusin ssh config tiedostoon:
<img width="433" height="193" alt="sshconfig" src="https://github.com/user-attachments/assets/cf8235a8-e3b5-4736-8e6c-75b4923bfd83" />

tämän jälkeen ajoin tiedoston saltilla ja sain tuloksen:
<img width="499" height="586" alt="ssh salt" src="https://github.com/user-attachments/assets/b96debe3-0f75-41e2-9f79-cbf949e2365c" />

(alkuperäinen tiedosto teki niin pitkän tulosteen että laitoin myöhemmän vaiheen kuvakaappauksen mutta tulos muuten sama)

seuraavaksi muokkasin tiedostoa /srv/salt/sshd/sshd_config niin että vaihdoin portin 2222 porttiin 1234 ja ajoin saltilla saman komennon uudestaan ja sain saman tuloksen.


Tämän jälkeen ajoin salt komennon vielä kerran ja sain tulokseksi: <img width="720" height="689" alt="ssh salt uudestaan" src="https://github.com/user-attachments/assets/7d86e74f-7b8e-44b8-81b3-b041af04a982" />
eli teidosto toimii.

## lähteet


Karvinen 2018: Pkg-File-Service – Control Daemons with Salt – Change SSH Server Port: https://terokarvinen.com/2018/04/03/pkg-file-service-control-daemons-with-salt-change-ssh-server-port/?fromSearch=karvinen%20salt%20ssh
