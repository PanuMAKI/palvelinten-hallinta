# H2 Infraa koodina

## c) tiivistelmät
## Karvinen 2014: Hello Salt Infra-as-Code
- artikkelissa kerrottaan mistä alkaa infra koodina.
- artikkeli kertoo miten tehdä teksti tiedosto ja miten sinne laitetaan koodia.
- tämän jälkeen tutustutaan koodin käyttämiseen. Kyseinen koodi joka artikkelissa on luo hakemiston nimeltä "hellotero"
  
## Salt contributors: Salt overview,kohdat: Rules of YAML, YAML simple structure, Lists and dictionaries - YAML block structures
- Salt projectin oma artikkeli jossa kerrottaan YAMl Kielen  petusteet
  
## Salt contributors: The top file, kohdat: Introduction, A basic example
- Toine salt projectin oma artikkeli.
- tässä artikkelissa esitellään top file joka on tiedosto jossa määritellään millä laite ryhmällä pitäisi olla mitäkin ladattuna
- Top file tarvitsee 3 komponenttia
- ympäristö, kohde ja lista tiedostoista mitö kuuluu olla ladattuna


## a) Infraa koodina paikallisesti

Ensin siirryin salt hakemistoon komennolla $ cd /srv/salt ja loin sinne uuden hakemiston nimeltä hello komenolla $ sudo mkdir -p /srv/salt/hello/.
tähän hakemistoon loin .sls tiedoston komenolla $ sudoedit init.sls tähän tiedostoon kirjoitin koodia seuraavasti 
<img width="297" height="102" alt="init sls 2" src="https://github.com/user-attachments/assets/f7b922e4-9732-4f63-8dfc-781cd2188922" />


ajoin tiedoston komenolla 

$ sudo salt-call --local state.apply hello

ja sain tuloksen:
<img width="599" height="399" alt="lopputulos" src="https://github.com/user-attachments/assets/32148d34-5338-4011-987e-acf4c70ffc65" />

tarkistin muutoksen komenolla $ cat /tmp/heitoimiiko 
<img width="447" height="40" alt="toimiiko" src="https://github.com/user-attachments/assets/c3accd41-591a-412f-b470-c5fb9239510f" />
## b) Top File
Loin uuden sls tiedoston salt hakemistoon komennolla $ sudoedit top.sls ja kirjoitin tiedostoon seuraavasti:<img width="126" height="75" alt="top sls" src="https://github.com/user-attachments/assets/96964df3-703a-45c8-88bb-bfd05eb42446" />

välissä kävin poistamassa heitoimiiko tiedoston komennnolla $ sudo rm heitoimiiko

seuraavaksi ajoin top filen komennolla $ sudo salt-call --local state.apply ja sain lopputulokseksi:<img width="598" height="397" alt="joku" src="https://github.com/user-attachments/assets/2dc333f1-7264-4645-bc45-de20424a662b" />

## c) Viisikko tiedostossa.
<img width="446" height="40" alt="viisikko" src="https://github.com/user-attachments/assets/b03ad547-b6cf-42b2-a3e6-bacbdecba63a" />

Pkg funktio lataa apache2: <img width="237" height="64" alt="pkg" src="https://github.com/user-attachments/assets/546de9a6-cf86-49cc-9861-99fbbdc529ca" />

file funktioksi laitoin saman kuin aiakisemmin tehtävässä. eli funktio luo "heitoimiiko" tiedoston /tmp/ hakemistoon.

service funktioni käynnistää apache2 :<img width="235" height="99" alt="service" src="https://github.com/user-attachments/assets/79b3dfe7-052c-45e1-b7a9-7c1ba8a98a0b" />

user funktio luo uuden käyttäjän nimeltä joku: <img width="201" height="73" alt="user" src="https://github.com/user-attachments/assets/46c22682-6cd4-41ab-91c6-4d7d9ff3ef03" />

cmd funktio tekee uuden tiedoston nimeltä uusi /tmp/ hakemistoon:
<img width="273" height="94" alt="cmd" src="https://github.com/user-attachments/assets/2e1f4772-20ed-48f7-992e-b77b9df2af5c" />

## d)
Tein uuden hakemiston komennolla $ sudo mkdir /srv/salt/kahta ja lisäsin sinne uuden sls tiedoston nimeltä init.sls komenolla $ sudoedit init.sls.

valitsin kahdeksi tilafunktioksi service ja user.
tein siis tiedoston joka käynnistää apache2 ohjelman jos se ei ole vielä käynnissä ja luo käyttäjän uusi jos sitä ei vielä ole olemassa.

Init.sls kansioon kirtjoitin: <img width="375" height="220" alt="kaksi" src="https://github.com/user-attachments/assets/429c8e2f-32a9-4316-a524-90c0893c41ad" />

tämän jälkeen ajoin sls tiedoston komennolla $ sudo salt-call --local state.apply kahta ja sain tuloksen: <img width="583" height="666" alt="kahta 12" src="https://github.com/user-attachments/assets/671f07eb-0f5f-476a-9d2e-88db17eccd0a" />

ajoin saman komennon uudestaan ja sain uuden tuloksen jossa näkyy että järjestelmään ei tehty muutoksia koska käyttäjä on jo olemassa ja apache2 käynnissä.
